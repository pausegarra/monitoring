apiVersion: 1

groups:
  - name: Infra
    folder: Infra
    interval: 1m
    rules:
      - uid: cpu_usage_high
        title: CPU Usage High
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: "max(system_cpu_usage) * 100"
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 80 ]
                    type: gt
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold

  - name: Health
    folder: Health
    interval: 1m
    rules:
      - uid: auth_health_down
        title: Auth Service Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://auth.pausegarra.es/health/live"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: festesdexert_down
        title: Festes de Xert Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://festesdexert.es"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: crossfitlambda_down
        title: CrossFit Lambda Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://crossfitlambda.es"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: latticeaxis_down
        title: LatticeAxis Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://latticeaxis.com"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: russian_cheatsheet_down
        title: Russian Cheat Sheet Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://russian-cheatsheet.pausegarra.es/api/q/health/live"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: sendif_down
        title: Sendif Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://sendif.pausegarra.es"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold
      - uid: yotanteo_down
        title: Yotanteo Down
        condition: C

        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: "feqjruau7xptsc"
            model:
              editorMode: code
              expr: 'probe_success{instance="https://yotanteo.com"}'
              instant: true
              intervalMs: 1000
              legendFormat: "__auto"
              maxDataPoints: 43200
              range: false
              refId: "A"

          - refId: C
            relativeTimeRange:
              from: 0
              to: 0
            datasourceUid: "__expr__"
            model:
              conditions:
                - evaluator:
                    params: [ 0 ]
                    type: eq
                  operator:
                    type: and
                  query:
                    params: [ "C" ]
                  reducer:
                    params: [ ]
                    type: last
                  type: query
              datasource:
                type: "__expr__"
                uid: "__expr__"
              expression: "A"
              intervalMs: 1000
              maxDataPoints: 43200
              refId: "C"
              type: threshold